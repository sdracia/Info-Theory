

pi=np.array([0.5,0.5])
gamma=np.array([[0.9,0.1],[0.1,0.9]])
r=np.array([[0.5,0],
            [0,0.5],
            [0.5,0],
            [0,0.5]])

Converges nicely

###################################################

pi=np.array([1.,0.,0.])
gamma=np.array([[0.8,0.1,0.1],
                [0.1,0.8,0.1],
                [0.1,0.1,0.8]])
r=np.array([[0.5,0.,0.],
            [0.,0.5,0.5],
            [0.5,0.,0.5],
            [0.,0.5,0.]])

Two of the states with one firing in common are confused, maybe try with more neurons

Estimated values for the parameters
Estimated Pi =  [8.56121502e-07 9.99999144e-01 5.12090774e-24]
Estimated Gamma =  [[0.80323745 0.07301438 0.16219722]
 [0.0604822  0.16535242 0.76191157]
 [0.13628035 0.76163321 0.07589122]]
Estimated R =  [[4.18060314e-01 1.77129309e-09 6.56911165e-05]
 [1.94708910e-02 4.70474680e-01 6.14350196e-01]
 [5.62468794e-01 2.08089291e-01 1.45886392e-01]
 [6.25280647e-10 3.21436028e-01 2.39697721e-01]]

###################################################

pi=np.array([1.,0.,0.])
gamma=np.array([[0.8,0.1,0.1],
                [0.1,0.8,0.1],
                [0.1,0.1,0.8]])
r=np.array([[1,0,0],
            [0,1,1],
            [1,0,1],
            [0,1,0],
            [0,0,1],
            [0,0,1]])

same as before

Estimated values for the parameters
Estimated Pi =  [1.23015155e-04 0.00000000e+00 9.99876985e-01]
Estimated Gamma =  [[0.22385826 0.11575124 0.65343083]
 [0.11897848 0.80169668 0.09329725]
 [0.65716327 0.08255209 0.25327193]]
Estimated R =  [[2.65015727e-01 1.06216273e-09 2.49957742e-01]
 [1.68160046e-01 5.10829741e-01 3.98638777e-02]
 [3.59836749e-01 8.67962388e-07 4.18772336e-01]
 [6.18810243e-06 4.72220106e-01 1.93282939e-08]
 [9.56922135e-02 8.76434028e-03 1.50322303e-01]
 [1.11289076e-01 8.18494410e-03 1.41083722e-01]]

###################################################

pi=np.array([1.,0.,0.])
gamma=np.array([[0.8,0.1,0.1],
                [0.1,0.8,0.1],
                [0.1,0.1,0.8]])
r=np.array([[1,0,0],
            [0,1,0],
            [1,0,0],
            [0,1,0],
            [0,0,1],
            [0,0,1]])